!(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.cubec=e()})(this,(function(){"use strict";function h(){return self||window||this}h.VERSION="4.2.6";var t={},e=[],n="",r=e.slice,u=t.toString,i=n.trim,o=e.concat,p=eval,c=Object.freeze({}),s=h();function a(t,e){h[e]=function(){return t}}function f(e,t){h[t]=function(t){return e[Xe(H(t).toLowerCase())]||e.default}}function l(n,t,r){return it(t,r?function(t,e){(E(r)?lt(r,e):null!=r&&e===r)||(n[e]=t)}:function(t,e){n[e]=t}),n}function v(t,e,n){return l(l(j(t)?[]:{},t),e,n)}function d(t,e,n){return b(e)?Object.defineProperties(t,e):Object.defineProperty(t,e,n)}function g(t){var e=Q(arguments,1);return function(){return t.apply(null,e.concat(Q(arguments)))}}function m(t,e){return function(){return(e.apply(null,arguments)?t:G).apply(null,arguments)}}function y(t){return"function"==typeof t}function b(t){return!!t&&("object"==typeof t||y(t))}function _(t){return"string"==typeof t||t+""===t}function O(t){return"boolean"==typeof t&&!!t===t}function x(t){return"number"==typeof t&&t===+t}function w(t){return null==t||"object"!=typeof t}function S(t){return t&&A(t,"RegExp")}var E=Array.isArray,k=/^[a-z$_]+[a-z$_0-9]*$/i;function T(t){return null!=t&&k.test(t)}function N(t){return 0 in arguments&&void 0!==t}function A(t,e){return u.call(t)==="[object "+e+"]"}function j(t){return!!t&&!y(t)&&b(t)&&x(t.length)}function C(t){return"number"==typeof t&&t!=t}function I(t){return+t===t&&t%1==0}function R(t){return+t===t&&t%1!=0}function M(t){return t instanceof Date}function P(t){return _(t)?!qn(t):w(t)||!qn(t)}function L(t){return b(t)&&0<t.nodeType&&(t instanceof Node||t instanceof Element)}function D(t){return t instanceof Element}function U(t){return t instanceof Node}function q(t){var e=Function.prototype.toString,n=Object.prototype.hasOwnProperty,r=RegExp("^"+e.call(n).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");try{var i=e.call(t);return r.test(i)}catch(t){return!1}}var J=["array","function","null","undefined","arguments","boolean","string","number","date","regexp","nodeList","htmlcollection"];function z(t){var e=[E(t),y(t),null===t,void 0===t,A(t,"Arguments"),A(t,"Boolean"),A(t,"String"),A(t,"Number"),A(t,"Date"),A(t,"RegExp"),A(t,"NodeList"),A(t,"HTMLCollection")];return J[bt(e,jt(!0))]||"object"}function F(t){return t}function $(){}function G(t){return t}function H(t){return null!=t?y(t.toString)?t.toString():t+"":""}function B(t){return+t&&"number"==typeof+t?+t:t>>0}function X(t){var e=parseInt(~t.indexOf("#")?t.substr(1):t,16);return{r:e>>16,g:(65280&e)>>8,b:255&e}}function W(t){return((1<<24)+(t.r<<16)+(t.g<<8)+t.b).toString(16).substr(1)}function K(t){var e=[];return b(t)||A(t,"String")?e=zn(t):null!=t&&e.push(t),e}function Y(t){return-B(t)}function Z(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function V(){return Q(arguments)}function Q(t,e,n){return j(t)?r.call(t,e,n):[]}function tt(t){return null!=t?E(t)||_(t)?Et(Object.keys(t),B):Object.keys(t):[]}function et(t,e){return void 0===e?t:function(){return t.apply(e,arguments)}}function nt(t,e,n){var r,i=t.length,o=et(e,n);for(r=0;r<i;r++)o(t[r],r,t);return t}function rt(e,n,t){return nt(tt(e),(function(t){n.call(this,e[t],t,e)}),t),e}function it(t,e,n){return j(t)?nt(t,e,n):b(t)&&null!==t?rt(t,e,n):t}function ot(t,e){if(j(t))return Q(t);if(b(t)&&e){var n,r,i=tt(t),o={};for(n=i.length;n--;)o[r=i[n]]=t[r];return o}return w(t)?t:JSON.parse(JSON.stringify(t))}var ut=function(){};function at(t){var e=t;if(j(t))e=Q(t).map(m(at,$n(w)));else if(!(w(t)||t instanceof Node)){rt(t,(function(t,e){this[e]=w(t)?t:at(t)}),e=(ut.prototype=t.constructor.prototype)!==Object.prototype?new ut:{})}return e}function ct(t,e){return t.test(e)}function st(t,e,n,r){var i=2 in arguments,o=et(e,r);return n=i?n:wt(t),Q(t,i?0:1).reduce(o,n)}function ft(t,e,n,r){var i=2 in arguments,o=et(e,r);return n=i?n:St(t),Q(t,0,i?void 0:-1).reduceRight(o,n)}function lt(t,e,n){var r,i=S(e)?ct:n?Oe:Nt,o=!1;if(j(t))for(r=t.length;r--&&!(o=i(e,t[r])););else if(b(t)){var u=tt(t);for(r=u.length;r--&&!(o=i(e,t[u[r]])););}return o}function ht(t,e,n){return lt(tt(t),e,n)}function pt(t,e,n){return n?t.splice(e,1):delete t[e]}function vt(t,e,n){for(var r=S(e)?ct:n?Oe:Nt,i=E(t),o=tt(t),u=0;u<o.length;u++)r(e,t[o[u]])&&pt(t,o[u],i)&&i&&(o.pop(),u--);return t}function dt(t,e,r){var n=[],i=S(e)?g(ct,e):y(e)?e:jt(e);return it(ot(t),(function(t,e,n){i.apply(n,arguments)&&this.push(r?e:t)}),n),n}function gt(t,e,n){return dt(t,$n(e),n)}function mt(t,e){var n,r,i=!0;for(r=(n=tt(t)).length;r--&&(i=e(t[n[r]],n[r],t)););return i}function yt(t,e){var n,r,i=!1;for(r=(n=tt(t)).length;r--&&!(i=e(t[n[r]],n[r],t)););return i}function bt(t,e){var n=dt(t,e,!0);return 1===n.length?n.pop():n.length?n:null}function _t(t,e){var n=bt(t,e);return w(n)?n:n.pop()}function Ot(t,e){var n=bt(t,e);return w(n)?n:n.shift()}function xt(t,e){var n=Ot(t,e);return null===n?n:t[n]}function wt(t){return j(t)?t[0]:t}function St(t){return j(t)?t[t.length-1]:t}function Et(t,r){var e=j(t),i=e?[]:{};return(e?nt:rt)(t,(function(t,e,n){i[e]=this?r.call(n,t,e,n):t[r]}),y(r)),i}function kt(e,n){var r={};return rt(e,(function(t){r[n.apply(e,arguments)]=t})),r}function Tt(t,e){var n,r,i=[],o=S(e)?g(ct,e):y(e)?e:jt(e);if(E(t))for(n=0,r=t.length;n<r;n++)o.call(t,t[n],n,t)&&i.push(t.splice(n,1).pop(n--));else if(b(t)){var u;for(u in t)if(o.call(t,t[u],u,t)){var a={};a[u]=t[u],i.push(a),delete t[u]}}return i}function Nt(t,e){return t===e}function At(t,e){return t!==e}function jt(e){return function(t){return t===e}}function Ct(t){for(var e={},n=x(wt(t)),r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0);return Et(tt(e),n?B:G)}function It(t,e){for(var n,r=Q(t),i=e?Oe:Nt,o=[],u=0;u<r.length;u++)if(void 0!==r[u])for(o.push(r[u]),n=u+1;n<r.length;n++)i(r[u],r[n])&&(r[n]=void 0);return o}function Rt(t,e){var n=y(e);return Et(t,(function(t){return(n?e:t[e]).apply(t,arguments)}))}function Mt(t,e,n){var r=[],i=H(e);return it(t,(function(t){var e=Pn(t,i,n);return void 0!==e&&this.push(e)}),r),r}function Pt(t,n){var e={},r=y(n);return it(t,(function(t){var e=r?n(t):Pn(t,n);e&&(this[e]?this[e].push(t):this[e]=[t])}),e),e}function Lt(t,n){var r={},i=y(n);return it(t,(function(t){var e=i?n(t):Pn(t,n);e&&(r[e]?this[e]+=1:this[e]=1)}),r),r}function Dt(t){var e,n,r=[],i=tt(t);for(e=0,n=i.length;e<n;e++)r.push([i[e],t[i[e]]]);return r}function Ut(t){var e,n,r={};for(e=0,n=t.length;e<n;e++)r[t[e][0]]=t[e][1];return r}function qt(t){return dt(t,$n(g(lt,re(Q(arguments,1),!0))))}function Jt(t){var n=re(Q(arguments,1),!0);return dt(t,(function(t,e){return!lt(n,e)}))}var zt=vt;function Ft(t){for(var e,n=t.length,r=new Array(n),i=0;i<n;i++)(e=ce(0,i))!==i&&(r[i]=r[e]),r[e]=t[i];return r}function $t(t,e){var n,r,i=parseInt(B(e))||2,o=[];for(n=0,r=t.length;n<r;n+=i)o.push(t.slice(n,n+i));return o}function Gt(t){return dt(t,G)}function Ht(){return o.apply([],arguments)}function Bt(a){return function(){var t,e,n,r=[],i=!0,o=Ht.apply([],arguments),u=a?Oe:Nt;for(t=0;t<o.length;t++){for(n=o[t],e=0;e<o.length;e++)if(t!==e&&u(n,o[e])){i=!1;break}i&&r.push(n),i=!0}return r}}var Xt=Bt(),Wt=Bt(!0);function Kt(a){return function(){var t,e,n,r,i=Q(arguments[0]),o=arguments.length,u=[];for(t=0;t<i.length;t++)if(r=!0,!lt(u,n=i[t],a)){for(e=1;e<o;e++)if(!lt(arguments[e],n,a)){r=!1;break}r&&u.push(n)}return u}}var Yt=Kt(),Zt=Kt(!0);function Vt(t,e){return!w(t)&&!w(e)&&(A(t,"Object")&&A(e,"Object")||j(t)&&j(e))}function Qt(t){var e,n=Q(arguments);return E(t)?st(n,(function(i,t){return nt(t,(function(t,e){var n=i[e],r=t;i[e]=Vt(n,r)?Qt(n,r):r})),e=i}),[]):b(t)&&st(n,(function(r,i){return nt(tt(i),(function(t){var e=r[t],n=i[t];r[t]=Vt(e,n)?Qt(e,n):n})),e=r}),{}),e}function te(t,e){return Q(t,B(e)||1)}function ee(t,e){return Q(t,0,-(B(e)||1))}function ne(t,e){var n,r=Q(t),i=void 0===this?"shift":"pop",o=S(e)?g(ct,e):y(e)?e:jt(e);for(n=r.length;n--&&!o(r[i]()););return r}function re(){var t=Ht.apply([],arguments),n=!!A(St(t),"Boolean")&&t.pop();return st(Q(t),(function(t,e){return t.concat(n&&E(e)?re(e,n):e)}),[])}var ie="0123456789",oe="abcdefghijklmnopqrstuvwxyz",ue=oe.toUpperCase(),ae="~`!@#$%^&*(){}[]-+=_|/.,><:;";function ce(t,e){return x(e)||(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}function se(t,e,n){x(e)||(e=t,t=0);var r=Math.random()*(e-t)+t;return B(n)?+r.toFixed(n):r}function fe(t){return 100*Math.random()<Math.max(1,Math.min(B(t||50),99))}function le(t,e){var n=t?ie+ae:"";return(n=(e?ue:oe)+n).charAt(ce(0,qn(n)-1))}function he(t){return(t?"#":"")+W({r:ce(0,255),g:ce(0,255),b:ce(0,255)})}function pe(t,e,n){for(var r=B(t)||2,i=[];r--;)i[r]=le(e,n);return i.join("")}function ve(){var t=Jn();return new Date(t+(fe()?G:Y)(ce(0,t)))}function de(t){return ce(1,(t=0<B(t)?B(t):2)%2==0?t:t+1)}function ge(t,e){var n=Q(arguments,2),r=xr[e]||xr.default;return Et(rr(t,0),(function(){return r.apply(null,n)}))}function me(i){var o=Q(arguments,1);return function(){for(var t=0,e=o.slice(),n=0,r=e.length;n<r;n++)e[n]===h&&(e[n]=arguments[t++]);for(;t<arguments.length;)e.push(arguments[t++]);return i.apply(this,e)}}function ye(t,e){var n;return function(){return 0<--t?n=e.apply(this,arguments):e=null,n}}function be(t,e){return me(ye,(B(e)||1)+1)(t)}function _e(t){return be(t)}function Oe(t,e){if(t===e||u.call(t)!==u.call(e)||w(t)&&w(e))return t===e;if(t.toString()===e.toString())if(E(t)){if(t.length===e.length){for(var n=t.length;n--;)if(!Oe(t[n],e[n]))return!1;return!0}}else{var r=tt(t),i=tt(e),o=r.length;if(r.length===i.length){for(;o--;)if(!Oe(t[r[o]],e[r[o]]))return!1;return!0}}return!1}var xe=/[\t\r\n\f\x20]/g,we=/([^&=]+)=?([^&]*)/g;function Se(t){var e={};return nt(t,(function(t){e[t.name]=t.value})),e}function Ee(t){return decodeURIComponent(t.replace(/\+/g," "))}function ke(t){return encodeURIComponent(t).replace(" ","%20")}function Te(t){for(var e,n=H(t).split("#").shift(),r=n.indexOf("?"),i={},o=~r?n.substr(r+1):n;e=we.exec(o);)i[Ee(e[1])]=Ee(e[2]);return delete i[o],i}function Ne(t){var e,n=ot(t);for(e in n)n[e]=ke(b(n[e])?JSON.stringify(n[e]):n[e]);return JSON.stringify(n).replace(/["{}]/g,"").replace(/:/g,"=").replace(/,/g,"&").replace(xe,"")}var Ae={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"$quot;","'":"&#x27;","`":"&#x60"},je={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#x27;":"'","&#x60;":"`"},Ce=/\\|'|\r|\n|\u2028|\u2029/g,Ie={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Re=/[&<">'](?:(amp|lt|quot|gt|#39);)?/g,Me=/&((g|l|quo)t|amp|#39);/g,Pe=/<script\b[^>]*>(.*?)<\/script>/gi,Le=/<!--([\s\S]*?)-->/gi,De=/[\t\r\n\f]/gim,Ue=/[A-Z]/g,qe="[\\s\\x20\\xA0\\uFEFF]+",Je=new RegExp(qe,"g"),ze=new RegExp("^"+qe,"g"),Fe=new RegExp(qe+"$","g"),$e=new RegExp(">"+qe+"<","g"),Ge=new RegExp("<"+qe,"g"),He=new RegExp(qe+">","g"),Be=new RegExp("</"+qe,"g");function Xe(t){return i.call(t)}function We(t){return t.replace(ze,"")}function Ke(t){return t.replace(Fe,"")}function Ye(t){var e=~t.search("-")?"-":~t.search("_")?"_":"";if(e){var n=1;for(e=t.split(e);n<e.length;n++)e[n]=Ze(e[n]);return e.join("")}return t}function Ze(t){return t.charAt(0).toUpperCase()+t.substr(1)}function Ve(t){return Xe(t).replace(De,"").replace(Je," ").replace($e,"><").replace(Ge,"<").replace(He,">").replace(Be,"</")}function Qe(t,e,n){var r=n?"toUpperCase":"toLowerCase",i=H(e)||"-";return t.replace(Ue,(function(t,e){return(0<e?i:"")+t[r]()}))}function tn(t){return Ae[t]||t}function en(t){return je[t]||t}function nn(t){return"\\"+Ie[t]}function rn(t){return+t===t?t:H(t).replace(Re,tn)}function on(t){return+t===t?t:H(t).replace(Me,en)}function un(t){return t.replace(Pe,"").replace(Le,"")}function an(t){return Ve(t.replace(Le,""))}var cn={escape:"{{-([\\s\\S]+?)}}",interpolate:"{{#([\\s\\S]+?)}}",command:"{{\\*([\\s\\S]+?)}}",evaluate:"{{([\\s\\S]+?)}}"},sn=/^([\S]+)\s?([\s\S]+)?/,fn=/[\[\]]*/g;function ln(t){var e=t,n=(e||"").trim(),r=n.slice(0,3),i=n.slice(0,5),o=n.slice(0,7),u=n[n.length-1];return"/if"!==n&&"/for"!==n&&"/"!==n||(e="}"),"}"!==u&&"{"!==u&&("if "===r||"if("===r?e="if("+n.slice(2)+"){":"elseif"===o||"elseif("===o||"esle if"===o?e="}else if("+n.slice(6)+"){":"elif "===i||"elif("===i?e="}else if("+n.slice(4)+"){":"else"===i&&(e="}else{")),e}function hn(t){var e="",n=sn.exec(Xe(t)),r=n[1],i=n[2];if(r)switch(r.toLowerCase()){case"/":case"end":case"/for":case"/each":case"/if":case"/exist":e="';}); _p+='";break;case"if":case"exist":e="'; var "+(i=i.split(" then "))[0]+" = "+i[0]+" || false; _ext("+i[0]+","+(i[1]?i[1].toString()+",":"")+"function(){ _p+='";break;case"for":case"each":e=pn("op",(i=i.split(" in "))[1],i[0]);break;case"not":case"cat":case"extend":e=vn(r,(i=i.split(" with "))[1],i[0]);break;default:e=vn(r,(i=i.split(" use "))[0],i[1]||"",!0)}return e}function pn(t,e,n){return"'; struct."+t+"()("+e+",function("+n.replace(fn,"")+"){ _p+='"}function vn(t,e,n,r){var i=t.split(":");return"'; "+(r?e+"=":"")+"struct."+i[0]+'("'+(i[1]||"")+'")('+e+","+n.replace(fn,"")+"); _p+='"}var dn={line:/[\r\n\f]/gim,quot:/\s*;;\s*/gim,space:/[\x20\xA0\uFEFF]+/gim,assert:/_p\+='(\\n)*'[^+]/gim,comment:/<!--(.*?)-->/gim,tagleft:/\s{2,}</gim,tagright:/>\s{2,}/gim};function gn(u,t,e){var n,r,a=0,c="_p+='",i,o=b(t)?e:_(t)?t:"",s=b(t)?t:{},f=Q(arguments,2),l=new RegExp(this.escape+"|"+this.interpolate+"|"+this.command+"|"+this.evaluate+"|$","g");Xe(u).replace(l,(function(t,e,n,r,i,o){return c+=u.slice(a,o).replace(Ce,nn),a=o+t.length,e?c+="'+((_t=("+e+"))==null?'':_(_t))+'":n?c+="'+((_t=("+n+"))==null?'':_t)+'":r?c+=hn(r,c):i&&(c+="';"+ln(i)+";_p+='"),t})),c=c.replace(dn.line,"").replace(dn.comment,"").replace(dn.assert,"").replace(dn.quot,";").replace(dn.space," ").replace(dn.tagright,"> ").replace(dn.tagleft," <"),c="with(__("+(o?"{}":"__({},_x_||{})")+",_bounds)){ "+c+"'; }",c="var _t,_d,_ext=struct.exist(),_=struct.html(\"encode\"),__=struct.extend(),_p=''; "+c+" return _p;";try{r=p("(function(_bounds,struct,"+(o||"_x_")+(f.length?","+f.toString():"")+"){ "+c+" })")}catch(t){throw console.error("[cubec view] Template parser Error!",{template:c}),t.res=c,t}return i=[s,h],n=function(){return Xe(r.apply(this,i.concat(Q(arguments))))},n}var mn=gn.bind(cn);function yn(){return Fn(mn.apply(this,arguments))}function bn(t){var r={};return nt(t?t.split(";"):[],(function(t){var e=(t||"").search("=");if(~e){var n=Xe(t.substr(0,e));n.length&&(r[n]=Xe(t.substr(e+1)))}})),r}function _n(t){var e=Q(arguments),n=e.length,r=bn(document.cookie);if(n){if(1===n)return r[t];var i=new Date;return i.setDate(i.getDate()+365),document.cookie=Xe(e[0]+"="+(e[1]||"")+";expires="+(e[2]||i.toUTCString())+";path="+(e[3]||"/")+";domain="+(e[4]||"")+";"+(e[5]?"secure":"")),!0}return r}var On={"application/x-www-form-urlencoded":0,"application/json":1};function xn(t,e,n){if(t)switch(e){case 0:return Ne(n||{});case 1:return JSON.stringify(n||{});default:return Ne(n||{})}return n}function wn(t){var o=l({url:"",type:"GET",param:c,charset:"utf-8",vaild:!0,cache:!1,success:$,error:$,loading:$,loadend:$,header:c,username:null,password:null,timeout:0,aysnc:!0,emulateJSON:!0,contentType:!0},t||{}),u=s.localStorage;if(y(o.param)&&(o.param=o.param()),o.cache){u.getItem("_")||u.setItem("_","{}");var e=JSON.parse(u.getItem("_"))[o.url||s.location.href.split("#").shift()];if(void 0!==e)return o.sucess.call(s,e)}var n,a=new XMLHttpRequest;return"GET"===o.type.toUpperCase()&&o.param&&(o.url+=(~o.url.search(/\?/g)?"&":tt(o.param).length?"?":"")+Ne(o.param),o.param=null),a.addEventListener("loadstart",o.loading),a.addEventListener("loadend",o.loadend),a.open(o.type,o.url,o.aysnc,o.username,o.password),n=b(o.header)&&o.header["Content-Type"]||"application/x-www-form-urlencoded",o.header!==c&&b(o.header)&&rt(o.header,(function(t,e){a.setRequestHeader(e,t)})),"POST"===o.type.toUpperCase()&&!0===o.contentType&&-1===(n||"").search("json")&&a.setRequestHeader("Content-Type",n+";chartset="+o.charset),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.onreadystatechange=function(e){if(4===a.readyState&&a.responseText){var t=a.status;if(200<=t&&t<300||304===t){var n;try{n=o.emulateJSON?JSON.parse(a.responseText):a.responseText}catch(t){return o.error.call(s,a.responseText,a,e)}if(o.success.call(s,n,a,e),o.cache){var r=JSON.parse(u.getItem("_"));r[o.url||s.location.href.split("#")[0]]=a.responseText,u.setItem("_",JSON.stringify(r))}}else{var i={};try{i=JSON.parse(a.response)}catch(t){console.error(t)}o.error.call(s,i,a,e)}}},B(o.timeout)&&(a.timeout=1e3*B(o.timeout),a.ontimeout=function(){4===a.readyState&&a.responseText||o.error.call(s,a),a.abort()}),a.send(o.param?b(o.param)?xn(o.contentType,On[n],o.param):o.param:null),a}function Sn(t){var e=l({url:"",key:"callback",param:c,timeout:5,error:$,success:$,callback:("structJSTP"+Math.random()).replace(".","")},t||{});y(e.param)&&(e.param=e.param());var n=e.url+"?"+Ne(e.param)+(tt(e.param).length?"&":"")+e.key+"="+e.callback,r=document.createElement("script");r.src=n,s[e.callback]=function(t){document.body.removeChild(r,lr(e.timesetup)),s[e.callback]=null,e.success(t)},document.body.append(r),B(e.timeout)&&(e.timesetup=fr((function(){document.body.removeChild(r),s[e.callback]=null,e.error()}),1e3*e.timeout))}function En(t,e,n,r){return y(e)&&(r=n,n=e,e=c),wn({url:t,param:e,success:n,error:r})}function kn(t,e,n,r){return y(e)&&(r=n,n=e,e=c),wn({url:t,type:"POST",param:e,success:n,error:r})}var Tn={},Nn=0;function An(t,e,n){var r=t._eid||0;return 0===r&&d(t,"_eid",{value:r=++Nn,writable:!1,enumerable:!1,configurable:!0}),Tn[r]||(Tn[r]={}),Tn[r][e]||(Tn[r][e]=[]),lt(Tn[r][e],n)||Tn[r][e].push(n),t}function jn(t,e,n){var r=t._eid||0;return r&&Tn[r]&&(Tn[r][e]?vt(Tn[r][e],n).length&&n||delete Tn[r][e]:e||n||(delete t._eid,delete Tn[r])),t}function Cn(t,e,n){var r=!1,i=t._eid||0;return i&&Tn[i]&&(r=y(n)&&Tn[i][e]?lt(Tn[i][e],n):qn(Tn[i][e])),!!r}function In(t,e){var n=(b(e)?e._eid:0)||0;return n&&(d(t,"_eid",{value:++Nn,writable:!1,enumerable:!1,configurable:!0}),Tn[t._eid]=at(Tn[n])),t}function Rn(t,e,n){var r=[],i=t._eid||0;return n=n||[],i&&Tn[i]&&""!==e&&rt(Tn[i][e],(function(t){r.push(t.apply(this,n))}),t),r}function Mn(t,e,n){return nt(H(e).split(","),(function(t){Rn(this,Xe(t),n)}),t),t}function Pn(t,e,n){var r,i,o,u=H(e||"").split("."),a=u.length-1;if(1===u.length)t.hasOwnProperty(e)&&(r=t[e]);else for(i=0,r=t;i<u.length;i++)if(o=w(r=r[u[i]]),i!==a&&o){r=void 0;break}if(n){var c=Q(arguments,3);y(n)?r=n.apply(r,(c.unshift(r),c)):_(n)&&(r=y(r[n])?r[n].apply(r,c):r[n])}return r}function Ln(t,e,n){var r,i,o,u,a=(e||"").split(".");if(1===a.length)t[e]=n;else{for(o=0,r=t,i=a.pop();o<a.length;o++)r=null==(u=r[a[o]])?{}:u;r[i]=n}return t}function Dn(t,e){var n,r,i,o=(e||"").split(".");if(1===o.length)t.hasOwnProperty(e)&&delete t[e];else{for(r=0,n=t,i=o.pop();r<o.length;r++)n=n[o[r]];E(n)?n.splice(B(i),1):delete n[i]}return t}function Un(t,e){return 1<B(e)?Q(Ft(t),0,B(e)):t[ce(qn(t)-1)]}function qn(t){return y(t)||null==t||C(t)?0:x(t.length)?t.length:b(t)?tt(t).length:0}function Jn(){return(new Date).getTime()}function zn(t,e){var n=[],r=_(e);return A(t,"String")?t.split(""):(it(t,(function(t){n.push(r?Pn(t,e):t)})),n)}function Fn(n,r){var i,o=[];return function(){var t,e=Q(arguments);for(i=o.length;i--;)if(Oe(o[i][0],e))return o[i][1];return o.push([e,t=n.apply(r||this,e)]),t}}function $n(t,e){var n=S(t)?g(ct,t):t;return y(n)?function(){return!n.apply(e,arguments)}:g(At,n).bind(e)}function Gn(){var e=Q(arguments);return function(t){return st(e,(function(t,e){return e(t)}),t)}}function Hn(t,e){if(b(t)&&_(e)&&e){var n=Pn(t,e);return n.sort.apply(n,Q(arguments,2)),t}return E(t)?t.sort.apply(t,Q(arguments,1)):t}function Bn(t){for(var e,n,r=0,i=t.length;r<i;r++){for(e=t[r],n=r-1;0<=n&&t[n]>e;)t[n+1]=t[n],n--;t[n+1]=e}return t}function Xn(t,e){return b(t)&&_(e)&&e?(Bn(Pn(t,e)),t):E(t)?Bn(t):t}function Wn(t,e,n){for(var r=t[n],i=e,o=e;i<n;i++)t[i]<r&&Z(t,i,o,o++);return Z(t,n,o),o}function Kn(t,e,n){if(!(n<e)){var r=Wn(t,e,n);Kn(t,e,r-1),Kn(t,r+1,n)}}function Yn(t){return Kn(t,0,t.length-1),t}function Zn(t,e){return b(t)&&!E(t)&&_(e)?(Yn(Pn(t,e)),t):E(t)?Yn(t):t}function Vn(t){var e=Q(arguments,1);t&&St(e).apply(this,e)}function Qn(){return nt(V.apply(null,arguments),Object.freeze).pop()}function tr(t,e,n){var r;return function(){r||fr((t.apply((r=1,n),arguments),function(){r=0}),e)}}function er(){return new nr(arguments)}function nr(t){d(this,{"-":{value:0 in t?t:void 0,writable:!0,enumerable:!1,configurable:!1},"=":{value:[],writable:!1,enumerable:!1,configurable:!1}})}function rr(t,e){var n,r=[];for(n=0;n<t;n++)r[n]=e;return r}function ir(t,n){var r={};return E(t)&&E(n)&&nt(t,(function(t,e){r[t]=n[e]})),r}nr.prototype.value=function(){return Gn.apply(null,this["="].splice(0,qn(this["="]))).apply(null,void 0===this["-"]?arguments:this["-"])};var or="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ur=s.btoa||function(t){for(var e,n,r=H(t),i="",o=0,u=or;r.charAt(0|o)||(u="=",o%1);i+=u.charAt(63&e>>8-o%1*8)){if(255<(n=r.charCodeAt(o+=.75)))throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|n}return i},ar=s.atob||function(t){var e=H(t).replace(/[=]+$/,""),n="";if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,o=0,u=0,a=or;i=e.charAt(u++);~i&&(r=o%4?64*r+i:i,o++%4)?n+=String.fromCharCode(255&r>>(-2*o&6)):0)i=a.indexOf(i);return n};function cr(t){return ur(unescape(encodeURIComponent(H(t))))}function sr(t){return decodeURIComponent(escape(ar(H(t).replace(/\s/g,""))))}function fr(t){return window.Promise?window.Promise.resolve().then(t):setTimeout(t,0)}function lr(t){clearTimeout(t)}var hr={obj:b,object:b,arr:E,array:E,arraylike:j,str:_,string:_,bool:O,boolean:O,num:x,number:x,fn:y,func:y,nan:C,prim:w,primitive:w,idt:T,identifier:T,def:A,define:A,int:I,float:R,double:R,date:M,ept:P,empty:P,dom:L,elm:D,element:D,node:U,text:U,native:q,need:N,require:N,required:N,type:z,default:z},pr={str:H,string:H,num:B,number:B,arr:K,array:K,hex:W,rgb:X,minus:Y,default:H},vr={arr:nt,array:nt,obj:rt,object:rt,each:it,default:it},dr={key:ht,index:ht,exist:lt,default:lt},gr={first:Ot,last:_t,single:xt,one:xt,index:bt,default:bt},mr={key:kt,hook:Rt,map:Et,default:Et},yr={fast:Ct,slim:It,default:It},br={un:Ut,unpair:Ut,pair:Dt,default:Dt},_r={at:Jt,with:zt,all:qt,default:qt},Or={left:te,right:ee,lefto:ne,leftto:ne,righto:ne.bind(!0),rightto:ne.bind(!0),default:te},xr={int:ce,float:se,double:se,str:pe,word:pe,string:pe,bool:fe,boolean:fe,char:le,letter:le,character:le,arr:ge,array:ge,date:ve,hex:he,dice:de,default:Math.random},wr={parse:Te,str:Ne,stringify:Ne,serialize:Ne,query:Se,requery:Se,default:Te},Sr={encode:rn,decode:on,strip:un,zip:an,default:Gn(un,an)},Er={trim:Xe,trimleft:We,trimright:Ke,came:Ye,camelize:Ye,capit:Ze,capitalize:Ze,collapse:Ve,rize:Qe,rizewith:Qe,default:H},kr={get:En,fetch:En,put:kn,post:kn,jsonp:Sn,cors:Sn,ajax:wn,default:wn},Tr={on:An,add:An,bind:An,off:jn,remove:jn,unbind:jn,has:Cn,exist:Cn,copy:In,extend:In,emit:Mn,trigger:Mn,dispatch:Mn,default:Mn},Nr={get:Pn,set:Ln,rm:Dn,not:Dn,remove:Dn,default:Pn},Ar={a2b:ar,atob:ar,btoa:ur,b2a:ur,utob:cr,u2b:cr,btou:sr,b2u:sr,default:ar},jr={left:st,right:ft,default:st},Cr={native:Hn,q:Zn,i:Xn,quick:Zn,insert:Xn,default:Hn},Ir={fast:Xt,slim:Wt,default:Xt},Rr={fast:Yt,slim:Zt,default:Yt},Mr={axt:yn,cache:yn,default:mn},Pr={chain:er,define:d,extend:l,depextend:v,keys:tt,noop:$,clone:ot,fireEvent:Rn,cloneDeep:at,depclone:at,not:vt,cat:Tt,slice:Q,find:dt,filter:dt,reject:gt,every:mt,some:yt,chunk:$t,compact:Gt,pluck:Mt,groupBy:Pt,countBy:Lt,concat:Ht,cast:V,shuffle:Ft,first:wt,last:St,flat:re,merge:Qt,auto:Un,part:be,once:_e,eq:Oe,cookie:_n,values:zn,memoize:Fn,negate:$n,link:Gn,size:qn,now:Jn,exist:Vn,lock:Qn,cool:G,hz:tr,fill:rr,combined:ir,ayc:fr,cyc:lr,v8:F},Lr={op:vr,each:vr,map:mr,has:dr,diff:Ir,intsec:Rr,type:hr,sort:Cr,html:Sr,unique:yr,convert:pr,pull:_r,param:wr,ajax:kr,event:Tr,prop:Nr,drop:Or,pairs:br,index:gr,random:xr,string:Er,reduce:jr,assembly:Ar,doom:Mr};rt(Pr,(function(t,e){nr.prototype[e]=function(){return this["="].push(t),this},a(t,e)})),rt(Lr,(function(e,t){nr.prototype[t]=function(t){return this["="].push(e[Xe(H(t).toLowerCase())]),this},f(Qn(e),t)})),h.root=s,h.broken=c,h.toString=H,h.prototype=h.__proto__=null;var Dr=Qn(F(h));function Ur(t){if(Array.isArray(t))return t}var qr=Ur;function Jr(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}var zr=Jr;function Fr(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var $r=Fr;function Gr(t,e){return qr(t)||zr(t,e)||$r()}var Hr=Gr,Br={DEFAULT_OPTION:{data:{},verify:{},emulateJSON:!0},IGNORE_KEYWORDS:["name","data","store","change","events","verify","filter","lock"],EMULATEHTTP:{get:"GET",send:"GET",post:"POST",sync:"POST",put:"POST",delete:"POST",patch:"POST",fetch:"GET"}},Xr={MODEL_UNEXPECT:"unexpect c.model with only data that accepts a standard JSON type object.",VIEW_MISSING_ROOT:"unexpect c.view must defined real root element node",ATOM_UNDEFINED_MODELNAME:"unexpect model name that atom can find it",ATOM_MISSING_MODELINSTANCE:"can not find target modal with atom.swap"},Wr=window.localStorage,Kr="CUBEC@",Yr=function(t){return t.split("").reverse().join("")},Zr={t:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ram:{},kAt:function(t,e){return t.charCodeAt(~~(e%t.length))},ecd:function(t){var e,n,r,i,o,u,a=0,c="";if(!t)return t;for(;e=(o=t[a++]<<16|t[a++]<<8|t[a++])>>18&63,n=o>>12&63,r=o>>6&63,i=63&o,c+=this.t.charAt(e)+this.t.charAt(n)+this.t.charAt(r)+this.t.charAt(i),a<t.length;);return((u=t.length%3)?c.slice(0,u-3):c)+"===".slice(u||3)},dcd:function(t){var e,n,r,i,o,u,a=0,c=[];if(!t)return t;for(t+="";e=(u=this.t.indexOf(t.charAt(a++))<<18|this.t.indexOf(t.charAt(a++))<<12|(i=this.t.indexOf(t.charAt(a++)))<<6|(o=this.t.indexOf(t.charAt(a++))))>>16&255,n=u>>8&255,r=255&u,c.push(e),64!==i&&(c.push(n),64!==o&&c.push(r)),a<t.length;);return c},incry:function(t,e){for(var n=0,r=t.length,i=[];n<r;n++)i[n]=t[n].charCodeAt(0)^this.kAt(e,n);return this.ecd(i)},decyt:function(t,e){for(var n=0,r=(t=this.dcd(t)).length;n<r;n++)t[n]=String.fromCharCode(t[n]^this.kAt(e,n));return t.join("")},set:function(t,e){Wr.setItem(Kr+this.incry(t,Yr(t)),this.incry(encodeURIComponent(JSON.stringify(e)),t))},get:function(t){var e=Wr.getItem(Kr+this.incry(t,Yr(t)));return e?JSON.parse(decodeURIComponent(this.decyt(e,t))):0},rm:function(t){Wr.removeItem(Kr+this.incry(t,Yr(t)))}};function Vr(t,e){return this.on(e,t)}var Qr=Dr.each("object"),ti=Dr.define();function ei(n,t){return Qr(t,(function(t,e){ti(n,e,{value:t,writable:!1,enumerable:!1,configurable:!1})})),n}var ni=Dr.broken,ri=Dr.keys(),ii=Dr.prop("get"),oi=Dr.convert("string"),ui=Dr.type();function ai(t,e){if(!e._v)return!0;for(var n,r,i,o=e._asv(ni),u=[],a=ri(o),c=0,s=a.length;c<s;c++)if(!(0,o[a[c]])(n=ii(t,a[c]))){u.push(a[c],n),console.error("model of key ( ".concat(a[c]," ) except error with model verify => ").concat(ui(n).toUpperCase()," [ ").concat(oi(n)," ]")),i=a[c];break}return(r=!u.length)||(e.emit("catch:verify",u),e.emit("catch:verify:".concat(i),u)),r}var ci=Dr.broken,si=Dr.prop("set"),fi=Dr.keys(),li=Dr.prop("get"),hi=Dr.find(),pi=Dr.convert("string"),vi=Dr.type();function di(t,e,n){if(!n._v)return!0;for(var r,i,o,u=n._asv(ci),a=si(n.get(),t,e),c=fi(u),s=new RegExp("^(".concat(t.replace(".","\\."),"|(").concat(t.replace(".","\\."),"\\.[^sS]*))$"),"m"),f=hi(c,s),l=[],h=0,p=f.length;h<p;h++)if(!(0,u[o=f[h]])(i=li(a,o))){l.push(o,i),console.error("model of key ( ".concat(f[h]," ) except error with model verify => ").concat(vi(i).toUpperCase()," [ ").concat(pi(i)," ]"));break}return(r=!l.length)||(n.emit("catch:verify",l),n.emit("catch:verify:".concat(o),l)),r}var gi=Dr.broken;function mi(t){var e=t._asl(gi);return e&&t.emit("catch:lock"),e}var yi=Dr.ajax();function bi(t,e,n,r,i,o){if(mi(this))return this;var u={url:e||this.url||"",type:Br.EMULATEHTTP[t],async:!0,emulateJSON:this.emulateJSON,param:n||this.param||{},header:o||this.header||{}};return"POST"===u.type&&this.emulateJSON&&(u.header["Content-Type"]="application/json"),u.header["X-HTTP-Method-Override"]=t,u.success=function(){try{r.apply(this,arguments)}catch(t){return console.error(t),this.emit("catch",[t])}this.emit(t+":success",arguments)}.bind(this),u.error=function(){try{i.apply(this,arguments)}catch(t){return console.error(t),this.emit("catch",[t])}this.emit(t+":error",arguments)}.bind(this),this.emit(t,[yi(u),u])}var _i=Dr.ajax();function Oi(r,i,o,u){var a=this;return mi(this)?this:new Promise(function(e,n){var t={url:i||a.url||"",type:Br.EMULATEHTTP[r],async:!0,emulateJSON:a.emulateJSON,param:o||a.param||{},header:u||a.header||{}};t.header["X-HTTP-Method-Override"]=r,t.success=function(t){e(t)},t.error=function(t){n(t)},a.emit(r,[_i(t),t])})}var xi=Dr.each("array"),wi=Dr.each("object"),Si=Dr.type("object"),Ei=Dr.type("arraylike"),ki=function n(t,r,e){var i=e||[];return null!=t&&(Ei(t)?xi(t,(function(t){n(t,r,i)})):Si(t)&&wi(t,(function(t,e){e===r&&i.push(t),n(t,r,i)}))),i},Ti=function(e,t){var n={};return xi(t,(function(t){n[t]=ki(e,t)})),n},Ni=Dr.each("object"),Ai=Dr.each("array"),ji=Dr.keys();function Ci(r){var t=[],n=0,i=ji(r);Ni(r,(function(t,e){n=t.length>n?t.length:n}));for(var e=function(e){var n={};Ai(i,(function(t){n[t]=r[t][e]})),t.push(n)},o=0;o<n;o++)e(o);return t}var Ii=Dr.type("func"),Ri=Dr.type("arraylike"),Mi=Dr.type("string"),Pi=Dr.event("on"),Li=Dr.event("off"),Di=Dr.event("emit");function Ui(t,e){return Ii(e)&&Mi(t)&&Pi(this,t,e),this}function qi(t,e){return Li(this,t,e)}function Ji(t,e){return Di(this,t,Ri(e)?e:[])}var zi=0,Fi=/^change:([a-zA-Z0-9_$.]+)$/,$i=/^change:/,Gi=Dr.broken,Hi=Dr.extend(),Bi=Dr.clone(),Xi=Dr.type("string"),Wi=Dr.type("bool"),Ki=Dr.type("object"),Yi=Dr.type("array"),Zi=Dr.type("prim"),Vi=Dr.type("func"),Qi=Dr.each("object"),to=Dr.each("array"),eo=Dr.cool(),no=Dr.size(),ro=Dr.prop("get"),io=Dr.prop("set"),oo=Dr.prop("rm"),uo=Dr.merge(),ao=Dr.noop(),co=Dr.slice(),so=Dr.not(),fo=Dr.eq(),lo=Dr.event("has");function ho(){var t=co(arguments),e={};try{1<t.length?to(t,(function(t){return e=uo(e,t)})):e=t[0]}catch(t){return console.error("[cubec model] the fetch data with parse error, please check server response data format with model-{ catch } event!"),this.emit("catch",[t]),!1}return e}var po=function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=Hi(Bi(Br.DEFAULT_OPTION),t);if(!Ki(e.data)||Yi(e.data))throw new Error(Xr.MODEL_UNEXPECT);var r=e.events,i=e.verify,o=Xi(e.name),u=Wi(e.store)&&e.store&&o,a=this.isLock=!!e.lock,c=[],s=[],f=e.data||{},l=u&&Zr.get(e.name)||f;f=Bi(l),Qi(r,Vr,ei(this,{name:o?e.name:void 0,_ast:function(t,e){var n=Vi(t)?t:eo;return e===Gi?n(f):{}},_mid:zi++,_asl:function(t){return t===Gi?a:null},_asv:function(t){return t===Gi?i:{}},_ash:function(t){return t===Gi?c:[]},_asc:function(t){return t===Gi?s:[]},_v:!!no(i),_l:function(t,e){return e===Gi?n.isLock=a=!!t:void 0},_c:function(t,e){return e===Gi?f=t:{}},_s:u})),o&&(Zr.ram[this.name]=this),Hi(this,e,Br.IGNORE_KEYWORDS).emit("init").off("init")};function vo(i,o,u,t){var a=[],e=i._asc(Gi);if(i.emit("change",[o,u]),e.length)if(t&&Xi(t)){var c="change:".concat(t),s=new RegExp("^".concat(c,"\\.([a-zA-Z_$0-9])+"));to(e,(function(t){if(c===t||s.test(t)){var e=t.replace($i,""),n=ro(o,e),r=ro(u,e);fo(n,r)||a.push([t,[n,r]])}}))}else to(e,(function(t){var e=t.replace($i,""),n=ro(o,e),r=ro(u,e);fo(n,r)||a.push([t,[n,r]])}));return to(a,(function(t){var e=Hr(t,2),n=e[0],r=e[1];i.emit(n,r)})),i}function go(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}po.prototype={constructor:po,emit:Ji,on:function(t){if(t&&Xi(t)){if(Fi.test(t)){var e=this._asc(Gi);-1===e.indexOf(t)&&e.push(t)}return Ui.apply(this,arguments)}},off:function(t,e){qi.apply(this,arguments);var n=this._asc(Gi);return t&&Xi(t)&&Fi.test(t)&&-1<=n.indexOf(t)&&!lo(this,t)?so(n,t):null==t&&n.splice(0,n.length),this},lock:function(){return this._l(!0,Gi),this.emit("lock")},unlock:function(){return this._l(!1,Gi),this.emit("unlock")},get:function(t,e){var n=this._ast(eo,Gi);return Bi(t||0===t?ro(n,t,e):n)},set:function(t,e,n){if(mi(this))return this;var r,i=this._ast(eo,Gi),o=this._ash(Gi),u=arguments.length,a=!Zi(t)&&Ki(t);if(u)if(a){if(n=e,(r=t)&&!fo(i,r)&&ai(r,this)){var c=Bi(i);if(this.history&&o.push(Bi(i)),this._c(r,Gi,this.change=!0),this._s&&Zr.set(this.name,r),!n)vo(this,Bi(r),c)}}else if(!fo(ro(i,t),e)&&di(t,e,this)){var s=Bi(i);if(this.history&&o.push(Bi(i)),io(i,t,e,this.change=!0),this._s&&Zr.set(this.name,i),!n)vo(this,Bi(i),s,t)}return this},remove:function(t,e){if(mi(this))return this;var n=this._ast(eo,Gi),r=this._ash(Gi);if(Zi(t)&&null!=t){var i=Bi(n);if(this.history&&r.push(Bi(n)),oo(n,t),this._s&&Zr.set(this.name,n),!e){var o=Bi(n);this.emit("remove:"+t),vo(this,o,i,t)}}return this},clear:function(t){var e={};return this.set(e,t),this._ast(eo,Gi)!==e||t||this.emit("clear"),this},back:function(t){if(mi(this)||!this.history)return this;var e,n=this._ash(Gi);if(n.length&&(e=n.pop())){var r=this.get();if(this._c(e,Gi,this.change=!0),!t){var i=Bi(e);this.emit("back",[i]),vo(this,i,r)}}return this},toJSON:function(){return JSON.stringify(this.get())},ajax:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=uo({type:"get",async:!0,success:ao,error:ao},t);return bi.call(this,e.type,e.url,e.param,e.success,e.error,e.header)},fetch:function(t,n){var r=this;t=t||this.param;var i=[],e=Yi(this.url)?this.url:Xi(this.url)?[this.url]:[],o=Yi(t)?t:Ki(t)?[t]:[],u=this.parse||ho;return to(e,(function(t,e){i.push(Oi.call(r,"fetch",t,o[e],n))})),1===i.length?i[0].then((function(t){var e=u.call(r,t);e&&(r.emit("fetch:success",[e]),r.set(e))}),(function(t){r.emit("fetch:error",[t]),console.error(t)})).catch((function(t){r.emit("catch",[t]),console.error(t)})):1<i.length&&Promise.all(i).then((function(t){var e=u.apply(r,t);e&&(r.emit("fetch:success",[e]),r.set(e))}),(function(t){r.emit("fetch:error",[t]),console.error(t)})).catch((function(t){r.emit("catch",[t]),console.error(t)})),this},sync:function(t,e){return Xi(t)?bi.call(this,"sync",t,this.get(),ao,ao,e):this},merge:function(t,e){return t instanceof po&&(t=t.get()),Ki(t)&&null!=t&&this.set(uo(this.get(),t),e),this},transTo:function(t,e,n){Vi(e)&&(n=e,e=!1);var r=Vi(n)?n:eo;return t instanceof po&&t.set(r(this.get()),e),this},seek:function(t,e){if(t&&(Xi(t)&&(t=[t]),Yi(t))){var n=Ti(this.get(),t);return e?Ci(n):n}return{}}};var mo=go;function yo(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}var bo=yo;function _o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var Oo=_o;function xo(t){return mo(t)||bo(t)||Oo()}var wo=xo;function So(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Eo=So,ko={DEFAULT_OPTION:{use:[]},IGNORE_KEYWORDS:["use","events","assert"]},To=Dr.cool(),No=Dr.type("string"),Ao=Dr.type("array"),jo=Dr.each("array"),Co=Dr.broken;function Io(t,e){var n=this,r=this._assert(To,Co),i=No(t)?[t]:Ao(t)?t:[];return jo(i,(function(t){return e.call(n,r,t)})),this}function Ro(e){return function(t){return t.name===e}}var Mo=Dr.type(),Po=Dr.each("array");function Lo(t,e){var n=[];switch(Mo(e)){case"regexp":Po(t,(function(t){return e.test(t.name)&&n.push(t)}));break;case"string":n.push(e);break;case"array":n=e;break;case"function":Po(t,(function(t){return e(t)&&n.push(t)}))}return n}function Do(e,n){return function(t){return t[e].apply(t,n)}}var Uo=Dr.extend(),qo=Dr.clone(),Jo=Dr.slice(),zo=Dr.has(),Fo=Dr.index(),$o=Dr.index("one"),Go=Dr.type("number"),Ho=Dr.type("function"),Bo=Dr.type("string"),Xo=Dr.type("boolean"),Wo=Dr.type("array"),Ko=Dr.type("arraylike"),Yo=Dr.cool(),Zo=Dr.every(),Vo=Dr.each("array"),Qo=Dr.map(),tu=Dr.size(),eu=Dr.broken,nu=Dr.noop(),ru=function(t){return t instanceof po},iu=0,ou=function(t,e,n,r){var i=Fo(t,Bo(e)?Ro(e):e);if(Go(i)){var o=t.splice(i,1).pop();ru(o)&&n&&o.off("change",r)}},uu=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=Uo(qo(ko.DEFAULT_OPTION),t),n=function(){this.transmit()}.bind(this),r=!!e.connect,i=[];ei(this,{_mid:"_at"+iu++,_assert:function(t,e){return e===eu?t(i):[]},_transmit:function(t){return t===eu?n:nu},_connecty:function(t){return t===eu?r:null}}),Uo(this.use(e.use,!0),e,ko.IGNORE_KEYWORDS)},au=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0,r=new uu({use:e,connect:n});return r.back=function(){return t},r};uu.prototype={constructor:uu,all:function(){return this._assert(Jo,eu)},use:function(t,e){var n=this._assert(Yo,eu),r=this._transmit(eu),i=this._connecty(eu),o=n.length;return ru(t)&&!zo(n,t)?(n.push(t),i&&t.on("change",r)):Ko(t)&&Zo(t,ru)?Vo(t,(function(t){zo(n,t)||(n.push(t),i&&t.on("change",r))})):(Bo(t)||Wo(t)&&Zo(t,Bo))&&Io.call(this,t,(function(t,e,n){(n=Zr.ram[e])&&!zo(t,n)&&(t.push(n),i&&n.on("change",r))})),o===n.length||e||this.transmit(),this},transmit:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=this.toChunk();return Bo(this.preset)&&this.preset&&(e=Eo({},this.preset,e)),Ji.call(this,"change",[e].concat(wo(t)))},out:function(t,e){var n=this._assert(Yo,eu),r=this._connecty(eu),i=this._transmit(eu),o=n.length;return ru(t)&&!zo(n,t)?ou(n,t,r,i):Ko(t)&&Zo(t,ru)?Vo(t,(function(t){ou(n,t,r,i)})):(Bo(t)||Wo(t)&&Zo(t,Bo))&&Io.call(this,t,(function(t,e){ou(t,e,r,i)})),o===n.length||e||this.transmit(),this},getModelByNames:function(t){var e,n=this;return null==t?e=this.all():Bo(t)?e=$o(this.all(),Ro(t)):Wo(t)&&tu(t)&&(e=Qo(t,(function(t){return n.getModelByNames(t)})),1===tu(e)&&(e=e[0])),e},of:function(t,e){return Vo(this.all(),Ho(t)?t:Do(t,e)),this},swap:function(t,e,n){if(!(t&&e&&Bo(t)&&Bo(e)))throw new Error(Xr.ATOM_UNDEFINED_MODELNAME);var r=this.getModelByNames(t),i=this.getModelByNames(e);if(!r||!i)throw new Error(Xr.ATOM_MISSING_MODELINSTANCE);var o=r.get();return r.set(i.get(),n),i.set(o,n),this},select:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return au(this,Lo(this.all(),t),e)},subscribe:function(t){return Ho(t)&&Ui.call(this,"change",t),this},unsubscribe:function(t){return Xo(t)&&t?qi.call(this,"change"):Ho(t)&&qi.call(this,"change",t),this},reset:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return this.unsubscribe(!0),this.out(this.all(),t),this},toData:function(){return Qo(this._assert(Yo,eu),(function(t){return t.get()}))},toChunk:function(){var e={};return this.of((function(t){t.name&&(e[t.name]=t.get())})),e}};var cu=Dr.type("required"),su=Dr.type("func"),fu=Dr.type("int"),lu=Dr.type("array"),hu=Dr.type("float"),pu=Dr.type("string"),vu=Dr.type("object"),du=Dr.type("number"),gu=Dr.type("primitive"),mu=Dr.type("arraylike"),yu=Dr.type("boolean"),bu=Dr.convert("string"),_u=Dr.v8(),Ou=function(r,i){return function(t,e){var n=r(t);return e?n:n||xu(t,"[ validation -> verify."+bu(i)+" ]")}},xu=function(t,e){return!1},wu=function(e){return function(t){return t instanceof e}},Su={isRequired:Ou(cu,"required"),isFunc:Ou(su,"function"),isInt:Ou(fu,"int"),isArray:Ou(lu,"array"),isFloat:Ou(hu,"float"),isString:Ou(pu,"string"),isObject:Ou(vu,"object"),isNumber:Ou(du,"number"),isArrayLike:Ou(mu,"arrayLike"),isPrimitive:Ou(gu,"primitive"),isBool:Ou(yu,"boolean"),isModel:Ou(wu(po),"model"),isAtom:Ou(wu(uu),"atom")},Eu=Object.freeze(_u(Su));function ku(e){return function(t){return new e(t||{})}}var Tu=Dr.merge();function Nu(n){return function(e){var t=function(t){return new n(Tu(e,t||{}))};return t.constructor=n,t._isExtender=!0,t}}var Au=Object.create(null);Au.version="1.4.0",Au.struct=Dr,Au.verify=Eu,Au.atom=ku(uu),Au.model=ku(po),Au.atom.extend=Nu(uu),Au.model.extend=Nu(po);var ju=Object.freeze(Au);return ju}));
